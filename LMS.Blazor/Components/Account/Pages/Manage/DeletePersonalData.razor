@page "/Account/Manage/DeletePersonalData"
@layout ManageLayout

@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Identity

@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject IdentityUserAccessor UserAccessor
@inject IdentityRedirectManager RedirectManager
@inject ILogger<DeletePersonalData> Logger

<PageTitle>Ta bort personlig data</PageTitle>

<div class="dash-card__head">Ta bort personlig data</div>

<StatusMessage Message="@message" />

<div class="row g-3">
    <div class="col-12">
        <div class="alert alert-danger">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <strong>Varning - Permanent borttagning</strong>
            <p class="mb-0 mt-2">
                Att ta bort denna data kommer permanent att ta bort ditt konto, och detta kan inte återställas.
            </p>
        </div>
    </div>
</div>

<div class="row g-3 mt-3">
    <div class="col-12">
        <EditForm Model="Input" FormName="delete-user" OnValidSubmit="OnValidSubmitAsync" method="post">
            <DataAnnotationsValidator />
            <ValidationSummary class="text-danger mb-3" role="alert" />

            @if (requirePassword)
            {
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="password" class="form-label text-muted small">Bekräfta med ditt lösenord</label>
                        <InputText type="password" @bind-Value="Input.Password" class="form-control"
                                   autocomplete="current-password" aria-required="true"
                                   placeholder="Ange ditt lösenord för att bekräfta" />
                        <ValidationMessage For="() => Input.Password" class="text-danger small" />
                    </div>
                </div>
            }

            <div class="mt-4">
                <button class="btn btn-danger" type="submit">
                    <i class="bi bi-trash me-2"></i>Ta bort data och stäng mitt konto
                </button>
            </div>
        </EditForm>
    </div>
</div>


