@page "/Account/Manage/ChangePassword"
@layout ManageLayout

@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Identity

@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject IdentityUserAccessor UserAccessor
@inject IdentityRedirectManager RedirectManager
@inject ILogger<ChangePassword> Logger

<PageTitle>Ändra lösenord</PageTitle>

<div class="dash-card__head">Ändra lösenord</div>

<StatusMessage Message="@message" />

<EditForm Model="Input" FormName="change-password" OnValidSubmit="OnValidSubmitAsync" method="post">
    <DataAnnotationsValidator />
    <ValidationSummary class="text-danger mb-3" role="alert" />

    <div class="row g-3">
        <div class="col-12">
            <label for="old-password" class="form-label text-muted small">Nuvarande lösenord</label>
            <InputText type="password" @bind-Value="Input.OldPassword" class="form-control"
                       autocomplete="current-password" aria-required="true"
                       placeholder="Ange ditt nuvarande lösenord" />
            <ValidationMessage For="() => Input.OldPassword" class="text-danger small" />
        </div>

        <div class="col-12">
            <label for="new-password" class="form-label text-muted small">Nytt lösenord</label>
            <InputText type="password" @bind-Value="Input.NewPassword" class="form-control"
                       autocomplete="new-password" aria-required="true"
                       placeholder="Ange ditt nya lösenord" />
            <ValidationMessage For="() => Input.NewPassword" class="text-danger small" />
        </div>

        <div class="col-12">
            <label for="confirm-password" class="form-label text-muted small">Bekräfta nytt lösenord</label>
            <InputText type="password" @bind-Value="Input.ConfirmPassword" class="form-control"
                       autocomplete="new-password" aria-required="true"
                       placeholder="Bekräfta ditt nya lösenord" />
            <ValidationMessage For="() => Input.ConfirmPassword" class="text-danger small" />
        </div>
    </div>

    <div class="mt-4">
        <button type="submit" class="btn btn-hero">
            <i class="bi bi-shield-lock me-2"></i>Uppdatera lösenord
        </button>
    </div>
</EditForm>


